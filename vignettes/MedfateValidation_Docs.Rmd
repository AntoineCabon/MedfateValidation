---
title: "Vignette Title"
author: "Vignette Author"
date: "`r Sys.Date()`"
params:
  wd: '/home/malditobarbudo/Documentos/00_Trabajo/CTFC/calibration_validation_medfate/work_structure/Validation'
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
knitr::opts_knit$set(root.dir = params$wd)
library(MedfateValidation)
```

## Load data and build medfate objects

`MedfateValidation` package provides methods to load the sites data and build
the needed `medfate` objects:

### Load data

  - `load_treeData(site)`
  - `load_shrubData(site)`
  - `load_seedData(site)`
  - `load_miscData(site)`
  - `load_meteoData(site)`
  - `load_soilData(site)`
  - `load_soilDataUnilayer(site)`
  - `load_measuredData(site)`
  - `load_terrainData(site)`
  - `load_customParams(site)`
  - `load_remarks(site)`

These functions try to load the corresponding data from the specified site,
indicated by the site code as character (i.e. `'CANBALASC'`). If the specified
data does not exist (some data are optional) the function will return `NULL`,
as expected by the build functions.

  - `load_rdatas(type = 'Global')`

This function allows for load the rdatas containing all the objects produced
along the validation process for all sites. It returns a list of environments
with the objects, that can be accessed as nested lists:  

```{r load_rdatas, eval = TRUE}
data <- load_rdatas('Global')
data$`CANBALSC`$terrainData$elevation
```

`type` argument indicates which reports to read the data from, "Global" for
the global validation and "Temperature" for the temperature validation.

  > All the load functions are expected to work with the **Validation** folder
    as the root directory.

### Build objects

  - `buildForest(treeData, shrubData, seedData, miscData)`
  - `buildSoil(soilData)`

These functions allows to build the `forest` and `soil` objects from `medfate`
package starting on the site data. `treeData`, `miscData` and `soilData` are the
only mandatory arguments, as the remaining can be `NULL` if they are not
available (see sites_data_structure vignette for more info about the site
data objects).

### Examples

If we want to work with the CANBALASC site, we can load the data and build the
objects to see a summary of them:

```{r load_example}
# site/plot code
code <- 'CANBALASC'

# params
data('newParams')

# raw data
treeData <- load_treeData(code)
shrubData <- load_shrubData(code)
seedData <- load_seedData(code)
customParams <- load_customParams(code)
measuredData <- load_measuredData(code)
meteoData <- load_meteoData(code)
miscData <- load_miscData(code)
soilData <- load_soilData(code)
terrainData <- load_terrainData(code)
remarks <- load_remarks(code)

# model objects
forest_object <- buildForest(treeData, shrubData, seedData, miscData)
soil_object <- buildSoil(soilData)

summary(forest_object, newParams)
soil_object
```

And, in the case of being interested to dive deep in the report for CANBALASC
site we can load the rdatas and inspect CANBALASC site:

```{r rdatas_example}
data <- load_rdatas('Global')
names(data)

canbalasc <- data$`CANBALASC`
names(canbalasc)
plot(canbalasc$res_complex, 'LAI')
```






Vignettes are long form documentation commonly included in packages. Because they are part of the distribution of the package, they need to be as compact as possible. The `html_vignette` output type provides a custom style sheet (and tweaks some options) to ensure that the resulting html is as small as possible. The `html_vignette` format:

- Never uses retina figures
- Has a smaller default figure size
- Uses a custom CSS stylesheet instead of the default Twitter Bootstrap style

## Vignette Info

Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette.

## Styles

The `html_vignette` template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows:

    output: 
      rmarkdown::html_vignette:
        css: mystyles.css

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
